---
import { getCollection } from 'astro:content';
import PageLayout from '../../layouts/PageLayout.astro';

// Get all blog posts and sort by date (newest first)
const allPosts = await getCollection('blog');

// Define desired post order (most recent first)
const postOrder = [
  'drones-vs-democracy',
  'cost-to-produce-to-zero',
  'legacy-vs-ai-native-companies',
  'your-brain-was-the-bottleneck',
  'ai-will-make-us-dumber'
];

const blogPosts = allPosts
  .filter(post => !post.data.draft)
  .sort((a, b) => {
    const indexA = postOrder.indexOf(a.slug);
    const indexB = postOrder.indexOf(b.slug);
    return indexA - indexB;
  });
---

<PageLayout
  title="Blog - Ramy Ghorayeb"
  description="Thoughts and essays on AI, technology, and the future"
>
  <div class="fade-in blog-list">
    <!-- Page Title -->
    <h1 class="text-4xl md:text-5xl font-bold mb-4">Blog</h1>

    <!-- RSS Link -->
    <div class="mb-16">
      <a href="/blog/rss.xml" class="text-sm font-mono hover:underline text-secondary" target="_blank" rel="noopener noreferrer">
        Subscribe via RSS
      </a>
    </div>

    <!-- Blog Posts List -->
    <section class="max-w-2xl">
      <div class="space-y-4">
        {blogPosts.map((post) => (
          <article class="border-b pb-4 border-default">
            <a href={`/blog/${post.slug}`} class="block group">
              <h2 class="text-lg font-semibold group-hover:underline text-primary">
                {post.data.title}
              </h2>
              <time class="text-sm text-secondary">
                {post.data.date}
              </time>
            </a>
          </article>
        ))}

        <!-- External Archive Links -->
        <article class="border-b pb-4 border-default">
          <a href="https://drive.google.com/drive/folders/1NwDriCu5_SupUEnB3GHi92BZaHF0pXoV?usp=drive_link" target="_blank" rel="noopener noreferrer" class="block group">
            <h2 class="text-lg font-semibold group-hover:underline text-primary">
              Civic tech
            </h2>
            <time class="text-sm text-secondary">
              2018 <span class="text-secondary">(Google drive link)</span>
            </time>
          </a>
        </article>

        <article class="border-b pb-4 border-default">
          <a href="https://drive.google.com/drive/folders/16kztSKtpdULc-24rJgf8cY4VU55M0AtS?usp=drive_link" target="_blank" rel="noopener noreferrer" class="block group">
            <h2 class="text-lg font-semibold group-hover:underline text-primary">
              Old tech blog
            </h2>
            <time class="text-sm text-secondary">
              2017 <span class="text-secondary">(Google drive link)</span>
            </time>
          </a>
        </article>
      </div>
    </section>
  </div>
</PageLayout>

<style is:global>
  /* Override lowercase for blog list titles */
  .blog-list h2,
  .blog-list time {
    text-transform: none !important;
  }
</style>
